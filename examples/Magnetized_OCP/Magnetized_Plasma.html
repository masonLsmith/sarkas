  <!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

<meta property="og:title" content="Magnetized Plasma" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://murillo-group.github.io/sarkas/examples/Magnetized_OCP/Magnetized_Plasma.html" />
  
<meta property="og:site_name" content="SARKAS: Python MD code for plasma physics" />
  
<meta property="og:description" content="This codes tests the Boris magnetic integrator by reproducing results of Bernu Journal de Physique, 42 L253 (1981). We simulate a One Component Plasma composed of N = 1000 Hydrogen atoms at a densi..." />
  
<meta property="twitter:card" content="summary">
<meta property="twitter:title" content="SARKAS: Python MD code for plasma physics">
<meta property="twitter:description" content="A fast pure-Python molecular dynamics suite for non-ideal plasmas.">
    <title>Magnetized Plasma &#8212; Sarkas 1.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=RocknRoll+One&display=swap" />
    <link rel="stylesheet" href="../../_static/my-styles.css" type="text/css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/myscript.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
  
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Yukawa vs Egs potential" href="../Yukawa_vs_EGS/Yukawa_vs_Exact-Gradient_Corrected_Potential.html" />
    <link rel="prev" title="Quantum Statistical Potential Simulation" href="../QSP/QSP_Tutorial.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/logo_s_orange.png"></span>
          ARKAS</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../documentation/get_started.html">Get Started</a></li>
                <li><a href="../examples.html">Examples</a></li>
                <li><a href="../../code_development/code_dev.html">Code Development</a></li>
                <li><a href="../../api/api.html">API</a></li>
                <li><a href="../../credits/credits.html">Credits</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/why_sarkas.html">Why Sarkas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/get_started.html">Get Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../theory/theory.html">Theoretical Background</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Dev:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/code_dev.html">Code Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Simulations:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/api.html">API reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Credits:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../credits/credits.html">Credits</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Magnetized Plasma</a></li>
<li><a class="reference internal" href="#Preprocessing">Preprocessing</a></li>
<li><a class="reference internal" href="#Simulation">Simulation</a></li>
<li><a class="reference internal" href="#PostProcessing">PostProcessing</a><ul>
<li><a class="reference internal" href="#Transport">Transport</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Magnetized-Plasma">
<h1>Magnetized Plasma<a class="headerlink" href="#Magnetized-Plasma" title="Permalink to this headline">¶</a></h1>
<p>This codes tests the Boris magnetic integrator by reproducing results of Bernu Journal de Physique, <strong>42</strong> L253 (1981).</p>
<p>We simulate a One Component Plasma composed of <span class="math notranslate nohighlight">\(N = 1000\)</span> Hydrogen atoms at a density of <span class="math notranslate nohighlight">\(n = 1.62 \times 10^{30}\)</span> <span class="math notranslate nohighlight">\(N/m^3\)</span>, and temperature <span class="math notranslate nohighlight">\(T = 0.3\)</span> <span class="math notranslate nohighlight">\(eV\)</span>, which leads to <span class="math notranslate nohighlight">\(\Gamma = 100\)</span>. The system is in a constant magnetic field <span class="math notranslate nohighlight">\(B = B_0 \hat{\mathbf z}\)</span> with <span class="math notranslate nohighlight">\(B_0 = 17 \times 10^6\)</span> Tesla. The ratio of the cyclotron frequency to the plasma frequency is <span class="math notranslate nohighlight">\(\beta \sim 1.0\)</span>.</p>
<p>The YAML input file can be found at <a class="reference external" href="https://raw.githubusercontent.com/murillo-group/sarkas/master/docs/examples/Magnetized_OCP/input_files/mag_ocp_mks_boris.yaml">input_file</a> and this notebook at <a class="reference external" href="https://raw.githubusercontent.com/murillo-group/sarkas/master/docs/examples/Magnetized_OCP/Magnetized_Plasma.ipynb">notebook</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the usual libraries</span>
<span class="o">%</span><span class="k">pylab</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;MSUstyle&#39;</span><span class="p">)</span>
<span class="c1"># Import sarkas</span>
<span class="kn">from</span> <span class="nn">sarkas.processes</span> <span class="kn">import</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">PostProcess</span><span class="p">,</span> <span class="n">PreProcess</span>

<span class="c1"># Create the file path to the YAML input file</span>
<span class="n">input_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;input_files&#39;</span><span class="p">,</span>  <span class="s1">&#39;mag_ocp_mks_boris.yaml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using matplotlib backend: Qt5Agg
Populating the interactive namespace from numpy and matplotlib
</pre></div></div>
</div>
</section>
<section id="Preprocessing">
<h1>Preprocessing<a class="headerlink" href="#Preprocessing" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preproc</span> <span class="o">=</span> <span class="n">PreProcess</span><span class="p">(</span><span class="n">input_file_name</span><span class="p">)</span>
<span class="n">preproc</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">read_yaml</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">preproc</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">timing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pppm_estimate</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span style="color: rgb(110,0,95)">





  _________             __
 /   _____/____ _______|  | _______    ______
 \_____  \\__  \\_  __ \  |/ /\__  \  /  ___/
 /        \/ __ \|  | \/    &lt;  / __ \_\___ \
/_______  (____  /__|  |__|_ \(____  /____  &gt;
        \/     \/           \/     \/     \/

</span>
An open-source pure-python molecular dynamics suite for non-ideal plasmas.





* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                                 Preprocessing
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

Job ID:  ocp_mag_boris
Job directory:  Simulations/ocp_mag_boris

Equilibration dumps directory:
 Simulations/ocp_mag_boris/PreProcessing/Equilibration/dumps
Production dumps directory:
 Simulations/ocp_mag_boris/PreProcessing/Production/dumps

Equilibration Thermodynamics file:
 Simulations/ocp_mag_boris/PreProcessing/Equilibration/EquilibrationEnergy_ocp_mag_boris.csv
Production Thermodynamics file:
 Simulations/ocp_mag_boris/PreProcessing/Production/ProductionEnergy_ocp_mag_boris.csv

PARTICLES:
Total No. of particles =  1000
No. of species =  1
Species ID: 0
        Name: H
        No. of particles = 1000
        Number density = 1.620000e+30 [N/m^3]
        Atomic weight = 1.0002 [a.u.]
        Mass = 1.673000e-27 [kg]
        Mass density = 2.710260e+03 [kg/m^3]
        Charge number/ionization degree = 1.0000
        Charge = 1.602177e-19 [C]
        Temperature = 3.330091e+03 [K] = 2.869650e-01 [eV]
        Debye Length = 3.128788e-12 [1/m]
        Plasma Frequency = 1.675504e+15 [rad/s]
        Cyclotron Frequency = 1.628034e+15 [rad/s]
        beta_c = 0.9717

SIMULATION AND INITIAL PARTICLE BOX:
Units:  mks
Wigner-Seitz radius = 5.282005e-11 [m]
No. of non-zero box dimensions =  3
Box side along x axis = 1.611992e+01 a_ws = 8.514549e-10 [m]
Box side along y axis = 1.611992e+01 a_ws = 8.514549e-10 [m]
Box side along z axis = 1.611992e+01 a_ws = 8.514549e-10 [m]
Box Volume = 6.172840e-28 [m^3]
Initial particle box side along x axis = 1.611992e+01 a_ws = 8.514549e-10 [m]
Initial particle box side along y axis = 1.611992e+01 a_ws = 8.514549e-10 [m]
Initial particle box side along z axis = 1.611992e+01 a_ws = 8.514549e-10 [m]
Initial particle box Volume = 6.172840e-28 [m^3]
Boundary conditions: periodic

ELECTRON PROPERTIES:
Number density: n_e = 1.620000e+30 [N/m^3]
Wigner-Seitz radius: a_e = 5.282005e-11 [m]
Temperature: T_e = 3.330091e+03 [K] = 2.869650e-01 [eV]
de Broglie wavelength: lambda_deB = 1.291671e-09 [m]
Thomas-Fermi length: lambda_TF = 3.382169e-11 [m]
Fermi wave number: k_F = 3.633390e+10 [1/m]
Fermi Energy: E_F = 5.029756e+01 [eV]
Relativistic parameter: x_F = 1.403067e-02 --&gt; E_F = 5.029509e+01 [eV]
Degeneracy parameter: Theta = 5.705346e-03
Coupling: r_s = 0.998154,  Gamma_e = 95.000103
Warm Dense Matter Parameter: W = 2.4019e-04
Chemical potential: mu = 1.7527e+02 k_B T_e = 9.9997e-01 E_F
Electron cyclotron frequency: w_c = 2.989994e+18
Lowest Landau energy level: h w_c/2 = 1.576582e-16
Electron magnetic energy gap: h w_c = 3.153163e-16 = 3.9128e+01 E_F = 6.8582e+03 k_B T_e

MAGNETIC FIELD:
Magnetic Field = [0.0000e+00, 0.0000e+00, 1.7000e+07] [Tesla]
Magnetic Field Magnitude = 1.7000e+07 [Tesla]
Magnetic Field Unit Vector = [0.0000e+00, 0.0000e+00, 1.0000e+00]

POTENTIAL:  coulomb
Effective Coupling constant: Gamma_eff = 95.00
Short-range Cutoff radius: rs = 0.000000e+00 [m]

ALGORITHM:  pppm
Charge assignment order: 6
FFT aliases: [3, 3, 3]
Mesh: 64 x 64 x 64
Ewald parameter alpha = 0.9000 / a_ws = 1.703898e+10 [1/m]
Mesh width = 0.2519, 0.2519, 0.2519 a_ws
           = 1.3304e-11, 1.3304e-11, 1.3304e-11 [m]
Mesh size * Ewald_parameter (h * alpha) = 0.2267, 0.2267, 0.2267
                                        ~ 1/4, 1/4, 1/4
rcut = 4.1700 a_ws = 2.202596e-10 [m]
No. of PP cells per dimension =  3,  3,  3
No. of particles in PP loop =    467
No. of PP neighbors per particle =     72
PM Force Error = 5.073538e-07
PP Force Error = 3.654934e-07
Tot Force Error = 6.252946e-07

THERMOSTAT:
Type: berendsen
First thermostating timestep, i.e. relaxation_timestep = 100
Berendsen parameter tau: 10.000 [timesteps]
Berendsen relaxation rate: 0.100 [1/timesteps]
Thermostating temperatures:
Species ID 0: T_eq = 3.330091e+03 [K] = 2.869650e-01 [eV]

INTEGRATOR:
Type: magnetic_boris_zdir
Time step = 1.100000e-17 [s]
Total plasma frequency = 1.675504e+15 [rad/s]
w_p dt = 0.0184 ~ 1/54

Equilibration:
No. of equilibration steps = 5000
Total equilibration time = 5.5000e-14 [s] ~ 92 w_p T_eq
snapshot interval step = 10
snapshot interval time = 1.1000e-16 [s] = 0.1843 w_p T_snap
Total number of snapshots = 500
Electrostatic Equilibration Type: magnetic_boris

Magnetization:
No. of magnetization steps = 5000
Total magnetization time = 5.5000e-14 [s] ~ 92 w_p T_mag
snapshot interval step = 10
snapshot interval time = 1.1000e-16 [s] = 0.1843 w_p T_snap
Total number of snapshots = 500

Production:
No. of production steps = 70000
Total production time = 7.7000e-13 [s] ~ 1290 w_p T_prod
snapshot interval step = 5
snapshot interval time = 5.5000e-17 [s] = 0.0922 w_p T_snap
Total number of snapshots = 14000


------------------------ Initialization Times ------------------------


Potential Initialization Time: 0 hrs 0 min 5 sec

Particles Initialization Time: 0 sec 0 msec 448 usec 27 nsec

Total Simulation Initialization Time: 0 hrs 0 min 5 sec


========================== Times Estimates ===========================

Optimal Green&#39;s Function Time:
0 min 3 sec 581 msec 556 usec 188 nsec

Time of PP acceleration calculation averaged over 100 steps:
0 min 0 sec 6 msec 205 usec 565 nsec

Time of PM acceleration calculation averaged over 100 steps:
0 min 0 sec 31 msec 773 usec 550 nsec


Running 101 equilibration and production steps to estimate simulation times

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3087ea95a72643bab021ff77b85a16b6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time of a single equilibration step averaged over 100 steps:
0 min 0 sec 42 msec 600 usec 652 nsec

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d74585ce2ae74c58a02d8da88d0b6760", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time of a single magnetization step averaged over 100 steps:
0 min 0 sec 38 msec 760 usec 2 nsec

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "353fd0e0c1e946199624f2333e4cfb9c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time of a single production step averaged over 100 steps:
0 min 0 sec 39 msec 127 usec 955 nsec



----------------------- Total Estimated Times ------------------------


Equilibration Time: 0 hrs 3 min 33 sec

Magnetization Time: 0 hrs 3 min 13 sec

Production Time: 0 hrs 45 min 38 sec

Total Run Time: 0 hrs 52 min 25 sec


========================= Filesize Estimates =========================


Equilibration:

Checkpoint filesize: 0 GB 0 MB 154 KB 10 bytes
Checkpoint folder size: 0 GB 75 MB 204 KB 904 bytes

Magnetization:

Checkpoint filesize: 0 GB 0 MB 154 KB 10 bytes
Checkpoint folder size: 0 GB 75 MB 204 KB 904 bytes

Production:

Checkpoint filesize: 0 GB 0 MB 154 KB 10 bytes
Checkpoint folder size: 2 GB 57 MB 616 KB 736 bytes

Total minimum needed space: 2 GB 208 MB 2 KB 496 bytes

Figures can be found in Simulations/ocp_mag_boris/PreProcessing/PPPM_Plots
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_3_7.png" src="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_3_7.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_3_8.png" src="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_3_8.png" />
</div>
</div>
<p>PreProcessing shows that we have chosen good parameters for the pppm algorithm. The black dot in the first plot shows our choice of parameters. This leads to a Total Force Error <span class="math notranslate nohighlight">\(\sim 9 \times 10^8\)</span>. The horizontal and vertical lines in the above plots represent the value <span class="math notranslate nohighlight">\(r = L/2 a_{\rm ws}\)</span>.</p>
<p>A common technique used in magnetized MD is to equilibrate the system in two steps. First without the presence of the magnetic field and then with the magnetic field turned on. This is because, the magnetic field can greatly delay the relaxation to equilibrium see <a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.95.013209">Ott et al PRE 2017</a>. Hence the magnetization phase before the production phase.</p>
<p>We confirm that our choice of parameters leads to the same physical system as the one simulated by Bernu. <span class="math notranslate nohighlight">\(\Gamma =95\)</span>, <span class="math notranslate nohighlight">\(\beta = 1.0\)</span>. Contrarily to Bernu we choose to run our simulation for a much longer time.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Production:
No. of production steps = 70000
Total production time = 7.7000e-13 [s] ~ 1290 w_p T_prod
snapshot interval step = 5
snapshot interval time = 5.5000e-17 [s] = 0.0922 w_p T_snap
Total number of snapshots = 14000
</pre></div>
</div>
<p>Bernu ran a simulation for 244 plasma periods. We decided to run for a time 5 times longer. This is because we want to show the time slicing option in the Postprocessing phase.</p>
<p>The estimated times, on this machine, are</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>----------------------- Total Estimated Times ------------------------


Equilibration Time: 0 hrs 3 min 30 sec

Magnetization Time: 0 hrs 3 min 1 sec

Production Time: 0 hrs 44 min 3 sec

Total Run Time: 0 hrs 50 min 35 sec
</pre></div>
</div>
<p>and the entire run requires a minimum of 132 MB of space on the hard drive.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Total minimum needed space: 2 GB 208 MB 2 KB 496 bytes
</pre></div>
</div>
<p>We are ready to start the simulation.</p>
</section>
<section id="Simulation">
<h1>Simulation<a class="headerlink" href="#Simulation" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sim = Simulation(input_file_name)</span>
<span class="c1"># sim.setup(read_yaml=True)</span>
<span class="c1"># sim.run()</span>
</pre></div>
</div>
</div>
</section>
<section id="PostProcessing">
<h1>PostProcessing<a class="headerlink" href="#PostProcessing" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">postproc</span> <span class="o">=</span> <span class="n">PostProcess</span><span class="p">(</span><span class="n">input_file_name</span><span class="p">)</span>
<span class="n">postproc</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">read_yaml</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">postproc</span><span class="o">.</span><span class="n">therm</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">postproc</span><span class="o">.</span><span class="n">therm</span><span class="o">.</span><span class="n">temp_energy_plot</span><span class="p">(</span><span class="n">postproc</span><span class="p">)</span>
<span class="c1"># postproc.therm.plot(scaling = 1.0e-15, y = &#39;Total Energy&#39;, logy = True, xlabel = r&#39;$t$ [fs]&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_9_0.png" src="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_9_0.png" />
</div>
</div>
<p>The energy remained fairly constant over the entire production phase. The Temperature similarly oscillated widly (<span class="math notranslate nohighlight">\(\sim 5 \%\)</span>) but its average is exactly the desired value. Both the Temperature and the Total Energy show a Gaussian distribution around their means.</p>
<p>We are ready to calculate the diffusion coefficient.</p>
<section id="Transport">
<h2>Transport<a class="headerlink" href="#Transport" title="Permalink to this headline">¶</a></h2>
<p>In the case of a magnetized plasma we have two diffusion coefficients:</p>
<div class="math notranslate nohighlight">
\[D_{\parallel}(\tau) = \frac{k_B T}{m} \int_0^\tau dt Z_{\parallel}(t), \quad D_{\perp}(\tau) = \frac{k_B T}{m} \int_0^\tau dt Z_{\perp}(t)\]</div>
<p>where, for the case of a constant magnetic field in the <span class="math notranslate nohighlight">\(z\)</span>-direction</p>
<div class="math notranslate nohighlight">
\[Z_{\parallel}(t) = \langle v_z(t)v_z(0) \rangle, \quad Z_{\perp}(t) = \frac{1}{2} \left [ \langle v_x(t)v_x(0) \rangle + \langle v_y(t)v_y(0) \rangle \right ],\]</div>
<p>are the velocity autocorrelation functions. These functions are calculated by the class <a class="reference external" href="../../api/sarkas.tools.observables.rst#sarkas.tools.observables.VelocityAutocorrelationFunction">VelocityAutocorrelationFunction</a> in <a class="reference external" href="../../api/sarkas.tools.observables.rst">sarkas.tools.observables</a>. This class calculates and saves <span class="math notranslate nohighlight">\(Z(t)\)</span> for each axis and the total <span class="math notranslate nohighlight">\(Z(t) = \frac{1}{3} \left [ Z_x(t) + Z_y(t) + Z_z(t) \right ]\)</span>.</p>
<p>Transport coefficient are calculated using the <a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients">TransportCoefficients</a> class from the <a class="reference external" href="../../api/sarkas.tools.transport.rst">sarkas.tools.transport</a>. This method requires the parameters of the simulation passed as <code class="docutils literal notranslate"><span class="pre">postproc.parameters</span></code>. The <code class="docutils literal notranslate"><span class="pre">phase</span></code> argument in this case is not needed since <code class="docutils literal notranslate"><span class="pre">production</span></code> is the default phase, and the number of slices in which to divide the simulation,<code class="docutils literal notranslate"><span class="pre">no_slices</span></code>. As
mentioned above we decided to run our simulation 5 times longer than Bernu’s. This is because we wanted to divide our long simulation into 5 small simulations of length ~ 258 <span class="math notranslate nohighlight">\(\omega_p T\)</span> (Bernu’s was 244 <span class="math notranslate nohighlight">\(\omega_p T\)</span>), calculate the diffusion coefficients for each of them, and average them.</p>
<p>Sarkas was created with this workflow in mind and the option <code class="docutils literal notranslate"><span class="pre">no_slices</span></code> allows to do exactly this.</p>
<p>Once the class is imported the diffusion coefficient is calculated by calling the method <a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients.diffusion">diffusion</a>. This method takes care of calculating the perpendicular and parallel diffusion coefficients, and plot their averages with a shaded area.</p>
<p>It is important to note that the <a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients.diffusion">diffusion</a> method assume a constant magnetic field in the <span class="math notranslate nohighlight">\(z\)</span>-direction. Arbitrary directions of the magnetic field are not supported at the moment.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sarkas.tools.observables</span> <span class="kn">import</span> <span class="n">VelocityAutoCorrelationFunction</span>
<span class="kn">from</span> <span class="nn">sarkas.tools.transport</span> <span class="kn">import</span> <span class="n">TransportCoefficients</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vacf</span> <span class="o">=</span> <span class="n">VelocityAutoCorrelationFunction</span><span class="p">()</span>
<span class="n">vacf</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="s1">&#39;production&#39;</span><span class="p">,</span> <span class="n">no_slices</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">#vacf.compute()</span>
<span class="n">vacf</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransportCoefficients</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">phase</span> <span class="o">=</span> <span class="s1">&#39;production&#39;</span><span class="p">,</span> <span class="n">no_slices</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">tc</span><span class="o">.</span><span class="n">diffusion</span><span class="p">(</span><span class="n">vacf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


======================= Diffusion Coefficient ========================

Data saved in:
 Simulations/ocp_mag_boris/PostProcessing/TransportCoefficients/Production/Diffusion_ocp_mag_boris.h5
Simulations/ocp_mag_boris/PostProcessing/TransportCoefficients/Production/Diffusion_slices_ocp_mag_boris.h5

No. of slices = 5
No. dumps per slice = 560
Time interval of autocorrelation function = 1.5400e-13 [s] ~ 258 w_p T
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1bcd6b810d8d4efba2f4f7a573c5b20e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_13_2.png" src="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_13_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_13_3.png" src="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_13_3.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Time</th>
      <th colspan="4" halign="left">H Diffusion</th>
    </tr>
    <tr>
      <th></th>
      <th>NaN</th>
      <th colspan="2" halign="left">Parallel</th>
      <th colspan="2" halign="left">Perpendicular</th>
    </tr>
    <tr>
      <th></th>
      <th>NaN</th>
      <th>Mean</th>
      <th>Std</th>
      <th>Mean</th>
      <th>Std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.500000e-17</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.100000e-16</td>
      <td>1.513632e-09</td>
      <td>1.449843e-11</td>
      <td>1.500904e-09</td>
      <td>9.712383e-12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.650000e-16</td>
      <td>3.022980e-09</td>
      <td>2.899158e-11</td>
      <td>2.985556e-09</td>
      <td>1.927020e-11</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.200000e-16</td>
      <td>4.523784e-09</td>
      <td>4.346764e-11</td>
      <td>4.437928e-09</td>
      <td>2.852923e-11</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2795</th>
      <td>1.537250e-13</td>
      <td>1.317944e-08</td>
      <td>2.338327e-09</td>
      <td>9.956043e-09</td>
      <td>1.893927e-09</td>
    </tr>
    <tr>
      <th>2796</th>
      <td>1.537800e-13</td>
      <td>1.315739e-08</td>
      <td>2.371333e-09</td>
      <td>9.951686e-09</td>
      <td>1.899606e-09</td>
    </tr>
    <tr>
      <th>2797</th>
      <td>1.538350e-13</td>
      <td>1.313432e-08</td>
      <td>2.404148e-09</td>
      <td>9.946636e-09</td>
      <td>1.905537e-09</td>
    </tr>
    <tr>
      <th>2798</th>
      <td>1.538900e-13</td>
      <td>1.311026e-08</td>
      <td>2.436658e-09</td>
      <td>9.940771e-09</td>
      <td>1.911840e-09</td>
    </tr>
    <tr>
      <th>2799</th>
      <td>1.539450e-13</td>
      <td>1.308527e-08</td>
      <td>2.468751e-09</td>
      <td>9.933983e-09</td>
      <td>1.918634e-09</td>
    </tr>
  </tbody>
</table>
<p>2800 rows × 5 columns</p>
</div></div>
</div>
<p>Once the calculation is complete <code class="docutils literal notranslate"><span class="pre">Sarkas</span></code> produces a figure for each diffusion coefficient containing two <code class="docutils literal notranslate"><span class="pre">subplots</span></code>: a plot of <span class="math notranslate nohighlight">\(Z_{\parallel}(t)(Z_{\perp}(t) )\)</span> on the left and a plot of <span class="math notranslate nohighlight">\(D_{\parallel}(\tau)\)</span> <span class="math notranslate nohighlight">\((D_{\perp}(\tau))\)</span> on the right. The above plots are in mks units, let’s rescale by <span class="math notranslate nohighlight">\(\omega_p a_{\rm ws}^2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rescaling</span> <span class="o">=</span> <span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">total_plasma_frequency</span> <span class="o">*</span> <span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">a_ws</span><span class="o">**</span><span class="mi">2</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Parallel&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span><span class="p">,</span>
       <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$D_{\parallel}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Parallel&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span> <span class="o">-</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Parallel&quot;</span><span class="p">,</span><span class="s2">&quot;Std&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span><span class="p">,</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Parallel&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span> <span class="o">+</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Parallel&quot;</span><span class="p">,</span><span class="s2">&quot;Std&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Perpendicular</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Perpendicular&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span><span class="p">,</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$D_{\perp}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Perpendicular&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span> <span class="o">-</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Perpendicular&quot;</span><span class="p">,</span><span class="s2">&quot;Std&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span><span class="p">,</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Perpendicular&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span> <span class="o">+</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Perpendicular&quot;</span><span class="p">,</span><span class="s2">&quot;Std&quot;</span><span class="p">)]</span><span class="o">/</span><span class="n">rescaling</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Parallel&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="n">rescaling</span><span class="p">,</span>
       <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Mov Avg&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[(</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span> <span class="s2">&quot;Perpendicular&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="n">rescaling</span><span class="p">,</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Mov Avg&#39;</span><span class="p">)</span>
<span class="c1"># ax.axhline(coefficient[&quot;H Parallel Diffusion avg&quot;].iloc[10]/rescaling)</span>
<span class="c1"># ax2.plot(diffusion[&quot;H Parallel Diffusion avg&quot;].expanding().mean()/rescaling, ls = &#39;&#39;)</span>
<span class="c1"># ax.grid(False)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\tau$ [fs]&#39;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$D_{\parallel,\perp}$ [$\omega_p a_</span><span class="si">{ws}</span><span class="s1">^2$]&#39;</span><span class="p">,</span> <span class="n">xscale</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1500</span><span class="o">*</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">xscale</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[None, Text(0.5, 0, &#39;Index&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_16_1.png" src="../../_images/examples_Magnetized_OCP_Magnetized_Plasma_16_1.png" />
</div>
</div>
<p>This gives a clearer picture of the diffusion coefficient. Note that the diffusion is a constant and not a function of time. This plot is meant to show how the diffusion changes as the upper limit of the time integration is varied. The final value to be published would be an average over the last ~ 800 diffusion values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The perpendicular diffusion is D_x = </span><span class="si">{:.4f}</span><span class="s1"> w_p a_ws^2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="mi">1</span><span class="o">/</span><span class="n">rescaling</span> <span class="o">*</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span><span class="s2">&quot;Perpendicular&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">800</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The parallel diffusion is D_z = </span><span class="si">{:.4f}</span><span class="s1"> w_p a_ws^2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="mi">1</span><span class="o">/</span><span class="n">rescaling</span> <span class="o">*</span> <span class="n">tc</span><span class="o">.</span><span class="n">diffusion_df</span><span class="p">[</span><span class="s2">&quot;H Diffusion&quot;</span><span class="p">,</span><span class="s2">&quot;Parallel&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">800</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The perpendicular diffusion is D_x = 0.0023 w_p a_ws^2
The parallel diffusion is D_z = 0.0029 w_p a_ws^2
</pre></div></div>
</div>
</section>
</section>


    </div>
      
  </div>
</div> 
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019-2022, MurilloGroup.<br/>
      Last updated on May 09, 2022.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br/>
    </p>
  </div>
</footer>

  <script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
      })
  </script>

  <style>
    /* Sidebar header (and topbar for mobile) */
    /* .wy-side-nav-search,  */
    .wy-nav-top {
      background: #18453b;
    }
    /* Sidebar */
    .wy-nav-side {
      background: #535054;
    }
    .wy-menu-vertical p.caption {
	  color: #fff;
    }
    .wy-menu-vertical a {
      color: #eee;
    }
    .wy-menu-vertical a:hover {
      background-color: #18453b;
    }
    /* .wy-nav-content {
      max-width: 900px !important;
    } */
  </style>

  </body>
</html>