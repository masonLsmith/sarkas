  <!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MD for Experiment Validation &#8212; Sarkas 1.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=RocknRoll+One&display=swap" />
    <link rel="stylesheet" type="text/css" href="../../_static/my-style.css" />
    <link rel="stylesheet" href="../../_static/my-styles.css" type="text/css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/myscript.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
  
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Ultrafast electron cooling in an expanding ultracold plasma" href="../Ultrafast_EC/Ultrafast_EC_Validation.html" />
    <link rel="prev" title="Moliere Potential" href="../Moliere/Moliere_Simulation.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/logo_s_orange.png"></span>
          ARKAS</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../documentation/get_started.html">Get Started</a></li>
                <li><a href="../examples.html">Examples</a></li>
                <li><a href="../../code_development/code_dev.html">Code Development</a></li>
                <li><a href="../../api/api.html">API</a></li>
                <li><a href="../../credits/credits.html">Credits</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/why_sarkas.html">Why Sarkas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/get_started.html">Get Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../theory/theory.html">Theoretical Background</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Dev:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/code_dev.html">Code Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Simulations:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/api.html">API reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Credits:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../credits/credits.html">Credits</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">MD for Experiment Validation</a><ul>
<li><a class="reference internal" href="#Ultracold-Neutral-Plasmas">Ultracold Neutral Plasmas</a></li>
<li><a class="reference internal" href="#Disorder-Induced-Heating">Disorder Induced Heating</a></li>
<li><a class="reference internal" href="#PreProcessing">PreProcessing</a></li>
<li><a class="reference internal" href="#Simulation">Simulation</a></li>
<li><a class="reference internal" href="#PostProcessing">PostProcessing</a><ul>
<li><a class="reference internal" href="#Distributions-for-Thermalization-analysis">Distributions for Thermalization analysis</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="MD-for-Experiment-Validation">
<h1>MD for Experiment Validation<a class="headerlink" href="#MD-for-Experiment-Validation" title="Permalink to this headline">¶</a></h1>
<p>The YAML input file can be found at <a class="reference external" href="https://raw.githubusercontent.com/murillo-group/sarkas/master/docs/examples/UNP/input_files/ucp_N10k.yaml">input_file</a> and this notebook at <a class="reference external" href="https://raw.githubusercontent.com/murillo-group/sarkas/master/docs/examples/UNP/UCP_Experiment_Validation.ipynb">notebook</a>.</p>
<section id="Ultracold-Neutral-Plasmas">
<h2>Ultracold Neutral Plasmas<a class="headerlink" href="#Ultracold-Neutral-Plasmas" title="Permalink to this headline">¶</a></h2>
<p>Sarkas has been developed with the experimental plasma physics community in mind. An example of strongly coupled plasmas are <a class="reference external" href="https://science.sciencemag.org/content/316/5825/705">Ultracold Neutral Plasmas</a>. In these systems a cloud of <span class="math notranslate nohighlight">\(N \sim 10^6 - 10^9\)</span> neutral atoms is trapped and cooled to ~mK temperatures. The cloud has a spherical Gaussian density distribution with peak densities in the range <span class="math notranslate nohighlight">\(\sim 10^{15}-10^{16}\, \textrm{N/cc}\)</span> with a standard deviation ranging from
hundreds of <span class="math notranslate nohighlight">\(\mu\)</span>m to few mm. A portion of the atoms is then ionized by shining a laser, with the correct wavelength, onto the cloud. The energy from the laser is deposited on the electrons which now have enough energy to escape the the atoms, thus, leaving behind positively charged ions.</p>
<p>UNPs are an optimal experimental setup to study strongly coupled plasmas since the charge number, the number density, and the temperature of the plasma are well defined and controllable. This is in contrast to other experiments in which some parameters are not well known and require simulations and models to be extracted from experimental data.</p>
<p>UNPs are considered strongly coupled plasmas because of their low kinetic energy. The strong coupling parameter is defined as</p>
<div class="math notranslate nohighlight">
\[\Gamma = \frac{(Ze)^2}{4\pi \varepsilon_0 a_{\rm ws}} \frac{1}{k_B T}\]</div>
<p>where <span class="math notranslate nohighlight">\(Z\)</span> is the charge number of the ions, <span class="math notranslate nohighlight">\(T\)</span> their temperature, and <span class="math notranslate nohighlight">\(a = (3/ 4\pi n)^{1/3}\)</span> is the Wigner-Seitz radius defined by the number density <span class="math notranslate nohighlight">\(n\)</span>. In UNP experiments <span class="math notranslate nohighlight">\(1 &lt; \Gamma \sim 10\)</span>.</p>
</section>
<section id="Disorder-Induced-Heating">
<h2>Disorder Induced Heating<a class="headerlink" href="#Disorder-Induced-Heating" title="Permalink to this headline">¶</a></h2>
<p>In the laser-cooling phase of the experiment atoms are neutral. This allows them to get very close to each other and distribute randomly in space. The potential energy in this case is very low and so is the kinetic energy. By photoionizing the atoms we are effectively turning on the Coulomb interaction. The system now has a large potential energy which pushes the ions apart, thus the potential energy is converted into kinetic energy (<span class="math notranslate nohighlight">\(\sim k_BT\)</span>). This process is called <strong>Disorder Induced
Heating (DIH)</strong>.</p>
<p>DIH is unavoidable and it is one of the biggest obstacles that prevents UNPs to reach <span class="math notranslate nohighlight">\(\Gamma &gt; 10\)</span>. This is because the initial potential energy is what determines the final temperature and the final <span class="math notranslate nohighlight">\(\Gamma\)</span>. Large potential energies lead to large kinetic energies and low <span class="math notranslate nohighlight">\(\Gamma\)</span>. Furthermore, in an experiment the temperature evolution of the ions in the DIH phase is used to determine/validate the number density of the initial charged cloud.</p>
<p>In the following example we will present a workflow to prepare and run an MD simulation and extract the DIH temperature of a UNP.</p>
</section>
<section id="PreProcessing">
<h2>PreProcessing<a class="headerlink" href="#PreProcessing" title="Permalink to this headline">¶</a></h2>
<p>We start by importing the usual libraries and creating a path to the input file of our simulation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pylab</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">sarkas.processes</span> <span class="kn">import</span> <span class="n">PreProcess</span><span class="p">,</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">PostProcess</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;MSUstyle&#39;</span><span class="p">)</span>
<span class="n">input_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;input_files&#39;</span><span class="p">,</span> <span class="s1">&#39;ucp_N10k.yaml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using matplotlib backend: Qt5Agg
Populating the interactive namespace from numpy and matplotlib
</pre></div></div>
</div>
<p>We then run the <code class="docutils literal notranslate"><span class="pre">PreProcess.run()</span></code> method to validate our simulation parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the class</span>
<span class="n">preproc</span> <span class="o">=</span> <span class="n">PreProcess</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
<span class="c1"># Setup Sarkas classes and initialize all the parameters</span>
<span class="n">preproc</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">read_yaml</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Run 100 steps to calculate the total time of the simulation.</span>
<span class="c1"># Also show plots of the Force error to validate the PPPM parameters.</span>
<span class="n">preproc</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">loops</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">pppm_estimate</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span style="color: rgb(110,0,95)">




 _______              __
|     __|.---.-.----.|  |--.---.-.-----.
|__     ||  _  |   _||    &lt;|  _  |__ --|
|_______||___._|__|  |__|__|___._|_____|


</span>
An open-source pure-python molecular dynamics code for non-ideal plasmas.



* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                                 Preprocessing
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

Job ID:  ucp_N10k
Job directory:  UCP_DIH_N10k/ucp_N10k
Equilibration dumps directory:  UCP_DIH_N10k/ucp_N10k/PreProcessing/Equilibration/dumps
Production dumps directory:  UCP_DIH_N10k/ucp_N10k/PreProcessing/Production/dumps
Random Seed =  651951

PARTICLES:
Total No. of particles =  10000
No. of species =  1
Species ID: 0
        Name: Sr
        No. of particles = 10000
        Number density = 4.000000e+15 [N/m^3]
        Atomic weight = 88.0000 [a.u.]
        Mass = 1.471907e-25 [kg]
        Mass density = 5.887629e-10 [kg/m^3]
        Charge number/ionization degree = 1.0000
        Charge = 1.602177e-19 [C]
        Temperature = 2.000000e-03 [K] = 1.723467e-07 [eV]
        Debye Length = 4.879672e-08 [Hz]
        Plasma Frequency = 8.876174e+06 [Hz]

SIMULATION BOX:
Units:  mks
Wigner-Seitz radius = 3.907963e-06 [m]
No. of non-zero box dimensions =  3
Box side along x axis = 3.472931e+01 a_ws = 1.357209e-04 [m]
Box side along y axis = 3.472931e+01 a_ws = 1.357209e-04 [m]
Box side along z axis = 3.472931e+01 a_ws = 1.357209e-04 [m]
Box Volume = 2.500000e-12 [m^3]
Boundary conditions: periodic

ELECTRON PROPERTIES:
Number density: n_e = 4.000000e+15 [N/m^3]
Wigner-Seitz radius: a_e = 3.907963e-06 [m]
Temperature: T_e = 4.300000e+02 [K] = 3.705453e-02 [eV]
de Broglie wavelength: lambda_deB = 3.594560e-09 [m]
Thomas-Fermi length: lambda_TF = 2.262611e-05 [m]
Fermi wave number: k_F = 4.910891e+05 [1/m]
Fermi Energy: E_F = 9.188478e-09 [eV]
Relativistic parameter: x_F = 0.000000 --&gt; E_F = 9.190629e-09 [eV]
Degeneracy parameter: Theta = 4032717.0039
Coupling: r_s = 73849.801701,  Gamma_e = 0.009944
Warm Dense Matter Parameter: W = 0.0000
Chemical potential: mu = -23.099609 k_B T_e = -93154186.8939 E_F

THERMOSTAT:
Type: Berendsen
First thermostating timestep, i.e. relaxation_timestep = 0
Berendsen parameter tau: 5.000 [s]
Berendsen relaxation rate: 0.200 [Hz]

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! WARNING !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Equilibration temperatures not defined. I will use the species&#39;s temperatures.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

Thermostating temperatures:
Species ID 0: T_eq = 2.000000e-03 [K] = 1.723467e-07 [eV]

POTENTIAL:  Yukawa
electron temperature = 4.3000e+02 [K] = 3.7055e-02 [eV]
kappa = 0.1727
Gamma_eff = 2137.95

ALGORITHM:  P3M
Mesh = 64 x 64 x 64
Ewald parameter alpha = 0.5700 / a_ws = 1.458560e+05 [1/m]
Mesh width = 0.5426, 0.5426, 0.5426 a_ws
           = 2.1206e-06, 2.1206e-06, 2.1206e-06 [m]
Mesh size * Ewald_parameter (h * alpha) = 0.3093, 0.3093, 0.3093
                                        ~ 1/3, 1/3, 1/3
rcut = 6.0050 a_ws = 2.346716e-05 [m]
No. of PP cells per dimension =  5,  5,  5
No. of particles in PP loop =   1395
No. of PP neighbors per particle =    216
PM Force Error = 3.482296e-06
PP Force Error = 3.181860e-06
Tot Force Error = 4.717056e-06

INTEGRATOR:
Type: Verlet
Time step = 3.019042e-10 [s]
Total plasma frequency = 8.876174e+06 [Hz]
w_p dt = 0.0027

Equilibration:
No. of equilibration steps = 0
Total equilibration time = 0.0000e+00 [s] ~ 0 w_p T_eq
snapshot interval step = 5
snapshot interval time = 1.5095e-09 [s] = 0.0134 w_p T_snap
Total number of snapshots = 0

Production:
No. of production steps = 10000
Total production time = 3.0190e-06 [s] ~ 26 w_p T_prod
snapshot interval step = 5
snapshot interval time = 1.5095e-09 [s] = 0.0134 w_p T_snap
Total number of snapshots = 2000


------------------------ Initialization Times ------------------------


Potential Initialization Time: 0 hrs 0 min 3 sec

Particles Initialization Time: 0 sec 1 msec 821 usec 58 nsec

Total Simulation Initialization Time: 0 hrs 0 min 3 sec


========================== Times Estimates ===========================

Optimal Green&#39;s Function Time:
0 min 3 sec 713 msec 803 usec 454 nsec

Time of PP acceleration calculation averaged over 15 steps:
0 min 0 sec 252 msec 560 usec 197 nsec

Time of PM acceleration calculation averaged over 15 steps:
0 min 0 sec 6 msec 4 usec 525 nsec


Running 15 equilibration and production steps to estimate simulation times

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "275ad8ea739e45b2a9b143cf52de447b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Time of a single equilibration step averaged over 15 steps:
0 min 0 sec 310 msec 992 usec 655 nsec

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5f8cd196431648dbb5ffbb624719eac4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Time of a single production step averaged over 15 steps:
0 min 0 sec 313 msec 249 usec 470 nsec



----------------------- Total Estimated Times ------------------------


Equilibration Time: 0 sec 0 msec 0 usec 0 nsec

Production Time: 0 hrs 52 min 12 sec

Total Run Time: 0 hrs 52 min 12 sec


========================= Filesize Estimates =========================


Equilibration:

Checkpoint filesize: 0 GB 0 MB 860 KB 822 bytes
Checkpoint folder size: 0 GB 0 MB 0 KB 0 bytes

Production:

Checkpoint filesize: 0 GB 0 MB 860 KB 822 bytes
Checkpoint folder size: 1 GB 657 MB 261 KB 480 bytes

Total minimum needed space: 1 GB 657 MB 261 KB 480 bytes
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_UNP_UCP_Experiment_Validation_4_5.png" src="../../_images/examples_UNP_UCP_Experiment_Validation_4_5.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_UNP_UCP_Experiment_Validation_4_6.png" src="../../_images/examples_UNP_UCP_Experiment_Validation_4_6.png" />
</div>
</div>
</section>
<section id="Simulation">
<h2>Simulation<a class="headerlink" href="#Simulation" title="Permalink to this headline">¶</a></h2>
<p>Once the simulation parameters have been decided we can start running our simulation. Since we are dealing with a non-equilibrium simulation, in order to get some statistics we need to run multiple simulations with different initial conditions. This can be done by changing the random number seed.</p>
<p>Below we show a sample code that executes three (3) MD simulation by changing only the <code class="docutils literal notranslate"><span class="pre">rand_seed</span></code> parameter and the storing directory.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a random number generator</span>
<span class="n">rg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PCG64</span><span class="p">(</span><span class="mi">154245</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># Loop over the number of independent MD runs to perform</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="c1"># Get a new seed</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15198</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Parameters&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;rand_seed&quot;</span><span class="p">:</span> <span class="n">seed</span><span class="p">},</span> <span class="c1"># define a new rand_seed for each simulation</span>

        <span class="s2">&quot;IO&quot;</span><span class="p">:</span>   <span class="c1"># Store all simulations&#39; data in simulations_dir,</span>
                <span class="c1"># but save the dumps in different subfolders (job_dir)</span>
            <span class="p">{</span>
                <span class="s2">&quot;simulations_dir&quot;</span><span class="p">:</span> <span class="s1">&#39;UCP_DIH_N10k&#39;</span><span class="p">,</span>
                <span class="s2">&quot;job_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;run</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="kc">False</span> <span class="c1"># This is so not to print to screen for every run</span>
            <span class="p">},</span>
    <span class="p">}</span>
    <span class="c1"># Run the simulation.</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">read_yaml</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">other_inputs</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Run </span><span class="si">{}</span><span class="s1"> completed&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Run 0 completed
Run 1 completed
Run 2 completed
Run 3 completed
Run 4 completed
</pre></div></div>
</div>
<p>The above code will take a long time, because we need to wait for the previous simulation to finish before starting a new one. Notice that we define the <code class="docutils literal notranslate"><span class="pre">rand_seed</span></code> parameter in each loop. This is because even though we are in the same Python process Sarkas has a default <code class="docutils literal notranslate"><span class="pre">rand_seed</span></code>. Thus, if we don’t pass it we will end up with three identical simulations.</p>
<p>If we can afford to occupy few processors on our computer we can save time by running each simulation in a different JupyterNotebook or by running three Python scripts at the same time.</p>
</section>
<section id="PostProcessing">
<h2>PostProcessing<a class="headerlink" href="#PostProcessing" title="Permalink to this headline">¶</a></h2>
<p>Once the simulations are done, we can start our Post Processing. In the following we will calculate the average temperature and RMS speed of each species in the mixture. Save them into a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">pandas.DataFrame</a> and plot them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the storing df</span>
<span class="n">Temp_vel_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># No. of independent runs</span>
<span class="n">runs</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Loop over the runs and initialize the PostProcess</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span>
    <span class="c1"># This is a copy-n-paste from the code snippet above. We only change sim with postproc</span>
    <span class="c1"># Some lines are commented out because they are not needed.</span>

    <span class="c1"># Get a new seed</span>
    <span class="c1">#seed = rg.integers(0, 1598765198)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># &quot;Parameters&quot;: {&quot;rand_seed&quot;: seed}, # define a new rand_seed for each simulation</span>

        <span class="s2">&quot;IO&quot;</span><span class="p">:</span>   <span class="c1"># Store all simulations&#39; data in simulations_dir,</span>
                <span class="c1"># but save the dumps in different subfolders (job_dir)</span>
            <span class="p">{</span>
                <span class="s2">&quot;simulations_dir&quot;</span><span class="p">:</span> <span class="s1">&#39;UCP_DIH_N10k&#39;</span><span class="p">,</span>
                <span class="s2">&quot;job_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;run</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="kc">False</span>  <span class="c1"># This is so not to print to screen for every run</span>
            <span class="p">},</span>
    <span class="p">}</span>

    <span class="n">postproc</span> <span class="o">=</span> <span class="n">PostProcess</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
    <span class="n">postproc</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">read_yaml</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">other_inputs</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># Rename the Thermodynamics class for convenience</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">postproc</span><span class="o">.</span><span class="n">therm</span>
    <span class="c1"># Setup its attributes</span>
    <span class="n">E</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
    <span class="c1"># Grab the data</span>
    <span class="n">E</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>

    <span class="c1"># Save the time array once. Obviously this has to be the same for each run.</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="c1"># scale by microsec</span>

    <span class="c1"># Grab the total temperature. This is the only line needed in the case of a One-Component plasma</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s1">&#39;Temperature run </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s1">&#39;Gamma run </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">qe</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">fourpie0</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">kB</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">a_ws</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">])</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s1">&#39;RMS Speed run </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">kB</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">postproc</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s look at the data</span>
<span class="n">Temp_vel_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time</th>
      <th>Temperature run 0</th>
      <th>Gamma run 0</th>
      <th>RMS Speed run 0</th>
      <th>Temperature run 1</th>
      <th>Gamma run 1</th>
      <th>RMS Speed run 1</th>
      <th>Temperature run 2</th>
      <th>Gamma run 2</th>
      <th>RMS Speed run 2</th>
      <th>Temperature run 3</th>
      <th>Gamma run 3</th>
      <th>RMS Speed run 3</th>
      <th>Temperature run 4</th>
      <th>Gamma run 4</th>
      <th>RMS Speed run 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.002012</td>
      <td>2125.666966</td>
      <td>0.434378</td>
      <td>0.001992</td>
      <td>2147.003605</td>
      <td>0.432214</td>
      <td>0.001993</td>
      <td>2145.592909</td>
      <td>0.432356</td>
      <td>0.002012</td>
      <td>2125.365953</td>
      <td>0.434409</td>
      <td>0.002005</td>
      <td>2132.681082</td>
      <td>0.433663</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.001510</td>
      <td>0.009476</td>
      <td>451.222732</td>
      <td>0.942801</td>
      <td>0.006148</td>
      <td>695.477531</td>
      <td>0.759406</td>
      <td>0.009681</td>
      <td>441.675962</td>
      <td>0.952936</td>
      <td>0.012002</td>
      <td>356.270734</td>
      <td>1.061025</td>
      <td>0.003814</td>
      <td>1121.000474</td>
      <td>0.598154</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.003019</td>
      <td>0.023311</td>
      <td>183.432031</td>
      <td>1.478693</td>
      <td>0.016799</td>
      <td>254.530966</td>
      <td>1.255294</td>
      <td>0.022098</td>
      <td>193.493293</td>
      <td>1.439735</td>
      <td>0.021207</td>
      <td>201.626702</td>
      <td>1.410398</td>
      <td>0.009698</td>
      <td>440.910836</td>
      <td>0.953763</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.004529</td>
      <td>0.038579</td>
      <td>110.834706</td>
      <td>1.902294</td>
      <td>0.029746</td>
      <td>143.745577</td>
      <td>1.670392</td>
      <td>0.035179</td>
      <td>121.547016</td>
      <td>1.816534</td>
      <td>0.031782</td>
      <td>134.538921</td>
      <td>1.726600</td>
      <td>0.018777</td>
      <td>227.720617</td>
      <td>1.327133</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.006038</td>
      <td>0.054996</td>
      <td>77.749003</td>
      <td>2.271267</td>
      <td>0.043874</td>
      <td>97.458663</td>
      <td>2.028642</td>
      <td>0.049228</td>
      <td>86.859581</td>
      <td>2.148853</td>
      <td>0.043945</td>
      <td>97.301324</td>
      <td>2.030282</td>
      <td>0.030239</td>
      <td>141.405760</td>
      <td>1.684155</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.007548</td>
      <td>0.072377</td>
      <td>59.078500</td>
      <td>2.605559</td>
      <td>0.058923</td>
      <td>72.567377</td>
      <td>2.350958</td>
      <td>0.064311</td>
      <td>66.487554</td>
      <td>2.456097</td>
      <td>0.057549</td>
      <td>74.299751</td>
      <td>2.323389</td>
      <td>0.043533</td>
      <td>98.223216</td>
      <td>2.020731</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.009057</td>
      <td>0.090588</td>
      <td>47.201953</td>
      <td>2.914980</td>
      <td>0.074789</td>
      <td>57.172839</td>
      <td>2.648627</td>
      <td>0.080374</td>
      <td>53.200328</td>
      <td>2.745734</td>
      <td>0.072451</td>
      <td>59.017560</td>
      <td>2.606904</td>
      <td>0.058304</td>
      <td>73.337758</td>
      <td>2.338578</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.010567</td>
      <td>0.109529</td>
      <td>39.039205</td>
      <td>3.205274</td>
      <td>0.091403</td>
      <td>46.780602</td>
      <td>2.928079</td>
      <td>0.097322</td>
      <td>43.935660</td>
      <td>3.021392</td>
      <td>0.088517</td>
      <td>48.306028</td>
      <td>2.881476</td>
      <td>0.074312</td>
      <td>57.539937</td>
      <td>2.640164</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.012076</td>
      <td>0.129121</td>
      <td>33.115612</td>
      <td>3.480160</td>
      <td>0.108710</td>
      <td>39.333349</td>
      <td>3.193267</td>
      <td>0.115059</td>
      <td>37.162774</td>
      <td>3.285198</td>
      <td>0.105623</td>
      <td>40.482759</td>
      <td>3.147608</td>
      <td>0.091377</td>
      <td>46.793979</td>
      <td>2.927660</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.013586</td>
      <td>0.149300</td>
      <td>28.639787</td>
      <td>3.742232</td>
      <td>0.126656</td>
      <td>33.760134</td>
      <td>3.446780</td>
      <td>0.133493</td>
      <td>32.030846</td>
      <td>3.538600</td>
      <td>0.123657</td>
      <td>34.578691</td>
      <td>3.405739</td>
      <td>0.109361</td>
      <td>39.099164</td>
      <td>3.202815</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate mean and std using a loop</span>

<span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;Gamma&quot;</span><span class="p">,</span> <span class="s2">&quot;RMS Speed&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>

    <span class="c1"># Average Temperature</span>
    <span class="n">mean_tot</span> <span class="o">=</span> <span class="n">Temp_vel_data</span><span class="p">[</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> run </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">)</span> <span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">std_tot</span> <span class="o">=</span> <span class="n">Temp_vel_data</span><span class="p">[</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> run </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">)</span> <span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Average and Standard Deviation of Total Temperature</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s1">&#39;Mean </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lbl</span><span class="p">)]</span> <span class="o">=</span> <span class="n">mean_tot</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s1">&#39;Std </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lbl</span><span class="p">)]</span> <span class="o">=</span> <span class="n">std_tot</span>

<span class="c1"># Save the data</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">simulations_dir</span><span class="p">,</span><span class="s1">&#39;Temp_vel_data.csv&#39;</span><span class="p">)</span>
<span class="n">Temp_vel_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="c1"># Let&#39;s look at the data again but only at the last additions</span>
<span class="n">Temp_vel_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Mean Temperature</th>
      <th>Std Temperature</th>
      <th>Mean Gamma</th>
      <th>Std Gamma</th>
      <th>Mean RMS Speed</th>
      <th>Std RMS Speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.002003</td>
      <td>0.000010</td>
      <td>2135.262103</td>
      <td>10.502982</td>
      <td>0.433404</td>
      <td>0.001065</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.008224</td>
      <td>0.003229</td>
      <td>613.129486</td>
      <td>310.765453</td>
      <td>0.862864</td>
      <td>0.183402</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.018623</td>
      <td>0.005561</td>
      <td>254.798766</td>
      <td>107.606476</td>
      <td>1.307576</td>
      <td>0.215196</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.030813</td>
      <td>0.007522</td>
      <td>147.677368</td>
      <td>46.462825</td>
      <td>1.688591</td>
      <td>0.220492</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.044456</td>
      <td>0.009173</td>
      <td>100.154866</td>
      <td>24.473638</td>
      <td>2.032640</td>
      <td>0.219039</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.059339</td>
      <td>0.010582</td>
      <td>74.131280</td>
      <td>14.730142</td>
      <td>2.351347</td>
      <td>0.215456</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.075301</td>
      <td>0.011797</td>
      <td>57.986087</td>
      <td>9.703094</td>
      <td>2.650965</td>
      <td>0.211079</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.092217</td>
      <td>0.012852</td>
      <td>47.120286</td>
      <td>6.810584</td>
      <td>2.935277</td>
      <td>0.206369</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.109978</td>
      <td>0.013773</td>
      <td>39.377695</td>
      <td>5.008591</td>
      <td>3.206779</td>
      <td>0.201543</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.128493</td>
      <td>0.014584</td>
      <td>33.621724</td>
      <td>3.817325</td>
      <td>3.467233</td>
      <td>0.196745</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>It is now time to plot and compare with experiment. For this tutorial we grabbed experimental data from Fig.~(2) of this <a class="reference external" href="http://dx.doi.org/10.1063/1.4915135">paper</a>. This data was obtained using <a class="reference external" href="https://automeris.io/WebPlotDigitizer/">WebPlotDigitizer</a> and saved into the file <code class="docutils literal notranslate"><span class="pre">paper_data.csv</span></code>.</p>
<p>We will plot both the temperature and the RMS speed side by side and compare with the experimental data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grab data from Killian</span>
<span class="n">paper_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;paper_data.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="c1"># Plot Temperature and thermal speed</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_temp</span><span class="p">,</span> <span class="n">ax_rms</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Plot Temperature</span>
<span class="n">Temp_vel_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Mean Temperature&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax_temp</span><span class="p">)</span>
<span class="c1"># Plot std error as shaded area</span>
<span class="n">ax_temp</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s2">&quot;Mean Temperature&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s2">&quot;Std Temperature&quot;</span><span class="p">],</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s2">&quot;Mean Temperature&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s2">&quot;Std Temperature&quot;</span><span class="p">],</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="c1"># Plot paper data</span>
<span class="n">ax_temp</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">paper_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">paper_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Paper Data&#39;</span><span class="p">)</span>
<span class="c1"># embellish</span>
<span class="n">ax_temp</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax_temp</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax_temp</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$T$ [K]&#39;</span><span class="p">,</span> <span class="n">xlabel</span> <span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Time [$\mu$s]&#39;</span><span class="p">)</span>

<span class="c1"># Plot Gamma</span>
<span class="c1"># Temp_vel_data.plot(x = &#39;Time&#39;, y = &#39;Mean Gamma&#39;, ax = ax_gamma)</span>
<span class="c1"># ax_gamma.fill_between(</span>
<span class="c1">#     Temp_vel_data[&#39;Time&#39;],</span>
<span class="c1">#     Temp_vel_data[&quot;Mean Gamma&quot;] - Temp_vel_data[&quot;Std Gamma&quot;],</span>
<span class="c1">#     Temp_vel_data[&quot;Mean Gamma&quot;] + Temp_vel_data[&quot;Std Gamma&quot;], alpha = 0.2)</span>

<span class="c1"># ax_gamma.grid(alpha = 0.3)</span>
<span class="c1"># ax_gamma.set(ylabel = r&#39;$\Gamma$&#39;, xlabel =r&#39;Time [$\mu$s]&#39;, ylim = (0, 5))</span>

<span class="c1"># Plot RMS Speed</span>
<span class="n">Temp_vel_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Mean RMS Speed&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax_rms</span><span class="p">)</span>
<span class="c1"># Plot std error as shaded area</span>
<span class="n">ax_rms</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s2">&quot;Mean RMS Speed&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s2">&quot;Std RMS Speed&quot;</span><span class="p">],</span>
    <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s2">&quot;Mean RMS Speed&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">Temp_vel_data</span><span class="p">[</span><span class="s2">&quot;Std RMS Speed&quot;</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># embellish</span>
<span class="n">ax_rms</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax_rms</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$v$ [m/s]&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Time [$\mu$s]&#39;</span><span class="p">)</span>

<span class="c1"># Finishing</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">simulations_dir</span><span class="p">,</span><span class="s1">&#39;Temperature_n_RMS_Plot.png&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_UNP_UCP_Experiment_Validation_13_0.png" src="../../_images/examples_UNP_UCP_Experiment_Validation_13_0.png" />
</div>
</div>
<p>Noice! There is good agreement for the first microsecond.</p>
<section id="Distributions-for-Thermalization-analysis">
<h3>Distributions for Thermalization analysis<a class="headerlink" href="#Distributions-for-Thermalization-analysis" title="Permalink to this headline">¶</a></h3>
<p>The next important quantity that we need are velocity distributions. Sarkas allows you to calculate these easily and automatically average of the multiple runs and over the three cartesian dimensions. The last two are flags that can be passed when calculating.</p>
<p>First we print the parameters of the velocity distributions</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sarkas.tools.observables</span> <span class="kn">import</span> <span class="n">VelocityDistribution</span>

<span class="n">vd</span> <span class="o">=</span> <span class="n">VelocityDistribution</span><span class="p">()</span>
<span class="n">vd</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
    <span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="c1"># We need to pass simulations parameters always</span>
    <span class="n">max_no_moment</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># This is the maximum number of distribution moments to calculate</span>
    <span class="n">multi_run_average</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Do we want to average over multiple runs ?</span>
    <span class="n">runs</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="c1"># Tell me the number of runs.</span>
    <span class="n">dimensional_average</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Do we want to average over the three directions?</span>
    <span class="n">max_hermite_order</span> <span class="o">=</span> <span class="mi">5</span>
<span class="p">)</span>

<span class="c1"># Let&#39;s print out some info</span>
<span class="n">vd</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


======================= Velocity Distribution ========================

CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/VelocityDistribution.csv
HDF5 dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/VelocityDistribution.h5
Data accessible at: self.dataframe, self.hierarchical_dataframe, self.species_bin_edges

Multi run average:  True
No. of runs:  5
Size of the parsed velocity array: 2001 x 1 x 150000

Histograms Information:
Species: Sr
No. of samples = 150000
Thermal speed: v_th = 1.207819e+01 [m/s]
density: True
bins: 200
range : ( -5.00, 5.00 ) v_th,
        ( -6.0391e+01, 6.0391e+01 ) [m/s]
Bin Width = 0.0500

Moments Information:
CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/Moments_run4.csv
Data accessible at: self.moments_dataframe, self.moments_hdf_dataframe
Highest moment to calculate: 10

Grad Expansion Information:
CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/HermiteCoefficients_run4.csv
Data accessible at: self.hermite_dataframe, self.hermite_hdf_dataframe
Highest order to calculate: 5
RMS Tolerance: 0.050
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s get the thermal speed of each species</span>
<span class="n">vd</span><span class="o">.</span><span class="n">vth</span>

<span class="c1"># Create a dictionary with the input arguments accepted by np.histogram</span>
<span class="n">hist_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="c1"># In a multispecies case you need to pass a list</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="o">*</span><span class="n">vd</span><span class="o">.</span><span class="n">vth</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">13</span><span class="o">*</span><span class="n">vd</span><span class="o">.</span><span class="n">vth</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="p">],</span>
    <span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="mi">520</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Reassign the attributes with the new dictionary</span>
<span class="n">vd</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
    <span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="c1"># We need to pass simulations parameters always</span>
    <span class="n">max_no_moment</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># This is the maximum number of distribution moments to calculate</span>
    <span class="n">multi_run_average</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Do we want to average over multiple runs ?</span>
    <span class="n">runs</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="c1"># Tell me the number of runs.</span>
    <span class="n">dimensional_average</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Do we want to average over the three directions?</span>
    <span class="n">max_hermite_order</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">hist_kwargs</span><span class="o">=</span> <span class="n">hist_kwargs</span><span class="p">,</span> <span class="c1"># &lt; === Here is the new dictionary</span>
<span class="p">)</span>

<span class="c1"># Let&#39;s print it again</span>
<span class="n">vd</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


======================= Velocity Distribution ========================

CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/VelocityDistribution.csv
HDF5 dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/VelocityDistribution.h5
Data accessible at: self.dataframe, self.hierarchical_dataframe, self.species_bin_edges

Multi run average:  True
No. of runs:  5
Size of the parsed velocity array: 2001 x 1 x 150000

Histograms Information:
Species: Sr
No. of samples = 150000
Thermal speed: v_th = 1.207819e+01 [m/s]
range : ( -13.00, 13.00 ) v_th,
        ( -1.5702e+02, 1.5702e+02 ) [m/s]
bins: 520
density: True
Bin Width = 0.0500

Moments Information:
CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/Moments_run4.csv
Data accessible at: self.moments_dataframe, self.moments_hdf_dataframe
Highest moment to calculate: 10

Grad Expansion Information:
CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/HermiteCoefficients_run4.csv
Data accessible at: self.hermite_dataframe, self.hermite_hdf_dataframe
Highest order to calculate: 5
RMS Tolerance: 0.050
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s finally calculate the distributions</span>
<span class="n">vd</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


======================= Velocity Distribution ========================

CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/VelocityDistribution.csv
HDF5 dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/VelocityDistribution.h5
Data accessible at: self.dataframe, self.hierarchical_dataframe, self.species_bin_edges

Multi run average:  True
No. of runs:  5
Size of the parsed velocity array: 2001 x 1 x 150000

Histograms Information:
Species: Sr
No. of samples = 150000
Thermal speed: v_th = 1.207819e+01 [m/s]
range : ( -13.00, 13.00 ) v_th,
        ( -1.5702e+02, 1.5702e+02 ) [m/s]
bins: 520
density: True
Bin Width = 0.0500

Moments Information:
CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/Moments_run4.csv
Data accessible at: self.moments_dataframe, self.moments_hdf_dataframe
Highest moment to calculate: 10

Grad Expansion Information:
CSV dataframe saved in:
          UCP_DIH_N10k/PostProcessing/Production/VelocityDistribution/HermiteCoefficients_run4.csv
Data accessible at: self.hermite_dataframe, self.hermite_hdf_dataframe
Highest order to calculate: 5
RMS Tolerance: 0.050

Collecting data from snapshots ...

Creating velocity distributions ...

Velocity distribution calculation Time: 0 hrs 0 min 3 sec

Calculating velocity moments ...

Velocity moments calculation Time: 0 hrs 0 min 16 sec

Calculating Hermite coefficients ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/luciano/Documents/Programming/sarkas/sarkas/tools/observables.py:3292: RuntimeWarning: invalid value encountered in true_divide
  ratios[:, :, :, mom] = moments[:, :, :, mom] / (const * moments[:, :, :, 1] ** (pwr / 2.))
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c4472b6702894c06b79c319ec0afb6a9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "247b6992c8b14c6fa6f71af1ed0ff058", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/luciano/anaconda3/envs/sarkas/lib/python3.7/site-packages/scipy/optimize/minpack.py:829: OptimizeWarning: Covariance of the parameters could not be estimated
  category=OptimizeWarning)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>



Hermite expansion calculation Time: 0 hrs 0 min 22 sec
</pre></div></div>
</div>
</section>
</section>
</section>


    </div>
      
  </div>
</div> 
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019-2022, MurilloGroup.<br/>
      Last updated on Mar 08, 2022.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br/>
    </p>
  </div>
</footer>

  <script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
      })
  </script>
  
  <style>
    /* Sidebar header (and topbar for mobile) */
    /* .wy-side-nav-search,  */
    .wy-nav-top {
      background: #18453b;
    }
    /* Sidebar */
    .wy-nav-side {
      background: #535054;
    }
    .wy-menu-vertical p.caption {
	  color: #fff;
	}
	.wy-menu-vertical a {
	  color: #eee;
	}
	.wy-menu-vertical a:hover {
    background-color: #18453b;
  }
 /* .wy-nav-content {
    max-width: 900px !important;
  } */
}
  </style>

  </body>
</html>