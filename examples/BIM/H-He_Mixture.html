  <!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>H-He Mixture &#8212; Sarkas 1.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=RocknRoll+One&display=swap" />
    <link rel="stylesheet" type="text/css" href="../../_static/my-style.css" />
    <link rel="stylesheet" href="../../_static/my-styles.css" type="text/css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/myscript.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
  
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Quantum Statistical Potential Simulation" href="../QSP/QSP_Tutorial.html" />
    <link rel="prev" title="One Component Plasma (OCP)" href="../OCP/OCP.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/logo_s_orange.png"></span>
          ARKAS</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../documentation/get_started.html">Get Started</a></li>
                <li><a href="../examples.html">Examples</a></li>
                <li><a href="../../code_development/code_dev.html">Code Development</a></li>
                <li><a href="../../api/api.html">API</a></li>
                <li><a href="../../credits/credits.html">Credits</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/why_sarkas.html">Why Sarkas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation/get_started.html">Get Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../theory/theory.html">Theoretical Background</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Dev:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/code_dev.html">Code Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Simulations:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/api.html">API reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Credits:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../credits/credits.html">Credits</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">H-He Mixture</a><ul>
<li><a class="reference internal" href="#Simulation">Simulation</a></li>
<li><a class="reference internal" href="#PostProcessing">PostProcessing</a><ul>
<li><a class="reference internal" href="#Thermodynamic-Check">Thermodynamic Check</a></li>
<li><a class="reference internal" href="#Pair-Distribution-Function">Pair Distribution Function</a></li>
<li><a class="reference internal" href="#Static-Structure-Function">Static Structure Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Interdiffusion">Interdiffusion</a><ul>
<li><a class="reference internal" href="#Transport-Coefficients-in-Sarkas">Transport Coefficients in Sarkas</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="H-He-Mixture">
<h1>H-He Mixture<a class="headerlink" href="#H-He-Mixture" title="Permalink to this headline">¶</a></h1>
<p>In this notebook we will calculate the diffusion and interdiffusion coefficients of Binary Ionic Mixture (BIM) of Hydrogen and Helium. This notebook tries to reproduce the data obtained from Hansen, Joly, and McDonald’s <a class="reference external" href="https://doi.org/10.1016/0378-4371(85)90022-6">paper</a>.</p>
<p>The YAML input file can be found at <a class="reference external" href="https://raw.githubusercontent.com/murillo-group/sarkas/master/docs/examples/BIM/input_files/BIM_cgs.yaml">input_file</a> and this notebook at <a class="reference external" href="https://raw.githubusercontent.com/murillo-group/sarkas/master/docs/examples/BIM/H-He_Mixture.ipynb">notebook</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the usual libraries</span>
<span class="o">%</span><span class="k">pylab</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;MSUstyle&#39;</span><span class="p">)</span>
<span class="c1"># Import sarkas</span>
<span class="kn">from</span> <span class="nn">sarkas.processes</span> <span class="kn">import</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">PostProcess</span>


<span class="c1"># Create the file path to the YAML input file</span>
<span class="n">input_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;input_files&#39;</span><span class="p">,</span> <span class="s1">&#39;BIM_cgs.yaml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using matplotlib backend: Qt5Agg
Populating the interactive namespace from numpy and matplotlib
</pre></div></div>
</div>
<section id="Simulation">
<h2>Simulation<a class="headerlink" href="#Simulation" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sim = Simulation(input_file_name)</span>
<span class="c1"># sim.setup(read_yaml=True)</span>
<span class="c1"># sim.run()</span>
</pre></div>
</div>
</div>
</section>
<section id="PostProcessing">
<h2>PostProcessing<a class="headerlink" href="#PostProcessing" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">postproc</span> <span class="o">=</span> <span class="n">PostProcess</span><span class="p">(</span><span class="n">input_file_name</span><span class="p">)</span>
<span class="n">postproc</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">read_yaml</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Thermodynamic-Check">
<h3>Thermodynamic Check<a class="headerlink" href="#Thermodynamic-Check" title="Permalink to this headline">¶</a></h3>
<p>Let’s make sure that the equilibration phase was <span class="math notranslate nohighlight">\(NVT\)</span> and the production phase <span class="math notranslate nohighlight">\(NVE\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Equilibration check</span>
<span class="n">postproc</span><span class="o">.</span><span class="n">therm</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
<span class="c1"># postproc.therm.temp_energy_plot(postproc, phase=&#39;equilibration&#39;)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Production check</span>
<span class="n">postproc</span><span class="o">.</span><span class="n">therm</span><span class="o">.</span><span class="n">temp_energy_plot</span><span class="p">(</span><span class="n">postproc</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s1">&#39;production&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_BIM_H-He_Mixture_8_0.png" src="../../_images/examples_BIM_H-He_Mixture_8_0.png" />
</div>
</div>
</section>
<section id="Pair-Distribution-Function">
<h3>Pair Distribution Function<a class="headerlink" href="#Pair-Distribution-Function" title="Permalink to this headline">¶</a></h3>
<p>Let’s look at <span class="math notranslate nohighlight">\(g_{\alpha \beta}(r)\)</span>. Just for fun.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">postproc</span><span class="o">.</span><span class="n">rdf</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
<span class="n">postproc</span><span class="o">.</span><span class="n">rdf</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<span class="n">postproc</span><span class="o">.</span><span class="n">rdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scaling</span> <span class="o">=</span> <span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">a_ws</span><span class="p">,</span>
                  <span class="n">y</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;H-H RDF&quot;</span><span class="p">,</span> <span class="s2">&quot;Mean&quot;</span><span class="p">),</span>
                      <span class="p">(</span><span class="s2">&quot;H-He RDF&quot;</span><span class="p">,</span> <span class="s2">&quot;Mean&quot;</span><span class="p">),</span>
                      <span class="p">(</span><span class="s2">&quot;He-He RDF&quot;</span><span class="p">,</span> <span class="s2">&quot;Mean&quot;</span><span class="p">)],</span>
                  <span class="n">xlabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$r / a_{\rm ws}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:xlabel=&#39;$r / a_{\\rm ws}$&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_BIM_H-He_Mixture_10_1.png" src="../../_images/examples_BIM_H-He_Mixture_10_1.png" />
</div>
</div>
</section>
<section id="Static-Structure-Function">
<h3>Static Structure Function<a class="headerlink" href="#Static-Structure-Function" title="Permalink to this headline">¶</a></h3>
<p>Let’s calculate <span class="math notranslate nohighlight">\(S_{\alpha\beta}(k)\)</span> up to <span class="math notranslate nohighlight">\(ka = 5\)</span> and angle average it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sarkas.tools.observables</span> <span class="kn">import</span> <span class="n">StaticStructureFactor</span>

<span class="n">ssf</span> <span class="o">=</span> <span class="n">StaticStructureFactor</span><span class="p">()</span>
<span class="n">ssf</span><span class="o">.</span><span class="n">no_slices</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ssf</span><span class="o">.</span><span class="n">angle_averaging</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span>
<span class="n">ssf</span><span class="o">.</span><span class="n">max_ka_value</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ssf</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
<span class="n">ssf</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


===================== Static Structure Function ======================

k wavevector information saved in:
 Simulations/HeH_sim/PostProcessing/k_space_data/k_arrays.npz
n(k,t) Data saved in:
 Simulations/HeH_sim/PostProcessing/k_space_data/nkt.h5
Data saved in:
 Simulations/HeH_sim/PostProcessing/StaticStructureFunction/Production/StaticStructureFunction_HeH_sim.h5
Data accessible at: self.k_list, self.k_counts, self.ka_values, self.dataframe

Smallest wavevector k_min = 2 pi / L = 3.9 / N^(1/3)
k_min = 0.2279 / a_ws = 9.2974e+08 [1/cm]

Angle averaging choice: full
        Maximum angle averaged k harmonics = n_x, n_y, n_z = 12, 12, 12
        Largest angle averaged k_max = k_min * sqrt( n_x^2 + n_y^2 + n_z^2)
        k_max = 4.7377 / a_ws = 1.9324e+10 [1/cm]

Total number of k values to calculate = 2196
No. of unique ka values to calculate = 354
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ssf</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<span class="n">ssf</span><span class="o">.</span><span class="n">dataframe</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Inverse Wavelength</th>
      <th colspan="2" halign="left">H-H SSF</th>
      <th colspan="2" halign="left">H-He SSF</th>
      <th colspan="2" halign="left">He-He SSF</th>
    </tr>
    <tr>
      <th></th>
      <th>NaN</th>
      <th>Mean</th>
      <th>Std</th>
      <th>Mean</th>
      <th>Std</th>
      <th>Mean</th>
      <th>Std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9.297400e+08</td>
      <td>0.602529</td>
      <td>0.602529</td>
      <td>-0.301900</td>
      <td>-0.301900</td>
      <td>0.151476</td>
      <td>0.151476</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.314851e+09</td>
      <td>0.950866</td>
      <td>0.950866</td>
      <td>-0.477511</td>
      <td>-0.477511</td>
      <td>0.240235</td>
      <td>0.240235</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.610357e+09</td>
      <td>0.739990</td>
      <td>0.739990</td>
      <td>-0.372485</td>
      <td>-0.372485</td>
      <td>0.188129</td>
      <td>0.188129</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.859480e+09</td>
      <td>0.752397</td>
      <td>0.752397</td>
      <td>-0.379395</td>
      <td>-0.379395</td>
      <td>0.192214</td>
      <td>0.192214</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.078962e+09</td>
      <td>1.002572</td>
      <td>1.002572</td>
      <td>-0.506872</td>
      <td>-0.506872</td>
      <td>0.257413</td>
      <td>0.257413</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>349</th>
      <td>1.785972e+10</td>
      <td>1.192680</td>
      <td>1.192680</td>
      <td>0.436384</td>
      <td>0.436384</td>
      <td>1.359468</td>
      <td>1.359468</td>
    </tr>
    <tr>
      <th>350</th>
      <td>1.826649e+10</td>
      <td>1.237796</td>
      <td>1.237796</td>
      <td>0.405055</td>
      <td>0.405055</td>
      <td>1.127594</td>
      <td>1.127594</td>
    </tr>
    <tr>
      <th>351</th>
      <td>1.831376e+10</td>
      <td>1.351196</td>
      <td>1.351196</td>
      <td>0.469020</td>
      <td>0.469020</td>
      <td>1.221888</td>
      <td>1.221888</td>
    </tr>
    <tr>
      <th>352</th>
      <td>1.880283e+10</td>
      <td>1.242406</td>
      <td>1.242406</td>
      <td>0.364108</td>
      <td>0.364108</td>
      <td>1.086201</td>
      <td>1.086201</td>
    </tr>
    <tr>
      <th>353</th>
      <td>1.932428e+10</td>
      <td>1.315648</td>
      <td>1.315648</td>
      <td>0.305602</td>
      <td>0.305602</td>
      <td>0.940871</td>
      <td>0.940871</td>
    </tr>
  </tbody>
</table>
<p>354 rows × 7 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ssf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">scaling</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span><span class="n">ssf</span><span class="o">.</span><span class="n">a_ws</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;H-H SSF&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;H-He SSF&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;He-He SSF&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">)],</span>
    <span class="n">xlabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$ka$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:xlabel=&#39;$ka$&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_BIM_H-He_Mixture_14_1.png" src="../../_images/examples_BIM_H-He_Mixture_14_1.png" />
</div>
</div>
</section>
</section>
<section id="Interdiffusion">
<h2>Interdiffusion<a class="headerlink" href="#Interdiffusion" title="Permalink to this headline">¶</a></h2>
<p>The interdiffusion coefficient is calculated by the Green-Kubo relation</p>
<div class="math notranslate nohighlight">
\[D_{12} = \frac{\mathcal{J}}{3Nx_1x_2} \int_0^\infty dt {\rm{{ACF}_{ID}}} = \frac{\mathcal{J}}{3Nx_1x_2} \int_0^\infty dt \langle \mathbf{j}(0) \cdot \mathbf{j}(t) \rangle,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{J}\)</span> is the thermodynamic factor</p>
<div class="math notranslate nohighlight">
\[\mathcal{J} = \frac{x_1x_2}{S_{cc}(k = 0)}\]</div>
<p>and <span class="math notranslate nohighlight">\(S_{cc}(k)\)</span> is the concentration-concentration structure factor that can be decomposed into partial structure factors as</p>
<div class="math notranslate nohighlight">
\[S_{cc}(k) = x_1x_2[x_2S_{11}(k) + x_1S_{22}(k) - 2\sqrt{x_1x_2}S_{12}(k)].\]</div>
<p>Calculating the interdiffusion coefficient <span class="math notranslate nohighlight">\(D_{12}\)</span> is two-fold in that we must compute the auto-correlation function <span class="math notranslate nohighlight">\(\rm{{ACF}_{ID}}\)</span> and the thermodynamic factor <span class="math notranslate nohighlight">\(\mathcal J\)</span>.</p>
<p>We will calculate <span class="math notranslate nohighlight">\(\mathcal J\)</span> first by fitting the following function to <span class="math notranslate nohighlight">\(S_{\alpha\beta}(k)\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define fitting functions</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>

<span class="k">def</span> <span class="nf">poly_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span>

<span class="k">def</span> <span class="nf">lin_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">inv_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>
</div>
</div>
<p>As you can see from above <span class="math notranslate nohighlight">\(S_{\alpha\beta}(k)\)</span> are pretty noisy. Therefore we choose only those <span class="math notranslate nohighlight">\(ka\)</span> values for which we have averaged more than three <span class="math notranslate nohighlight">\(S_{\alpha\beta}(k)\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create masks</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">ssf</span><span class="o">.</span><span class="n">k_counts</span> <span class="o">&gt;</span> <span class="mi">3</span>
<span class="n">ka_values_full</span> <span class="o">=</span> <span class="n">ssf</span><span class="o">.</span><span class="n">ka_values</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="n">ka_mask</span> <span class="o">=</span> <span class="n">ka_values_full</span> <span class="o">&lt;</span> <span class="mf">3.0</span>
<span class="n">ka_values</span> <span class="o">=</span> <span class="n">ka_values_full</span><span class="p">[</span><span class="n">ka_mask</span><span class="p">]</span>

<span class="c1"># Remake the plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">ssf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">scaling</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span><span class="n">ssf</span><span class="o">.</span><span class="n">a_ws</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;H-H SSF&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;H-He SSF&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;He-He SSF&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">)],</span>
    <span class="n">xlabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$ka$&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>

<span class="c1"># H-H Fit and plot</span>
<span class="n">sk_array_full</span> <span class="o">=</span> <span class="n">ssf</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[(</span><span class="s2">&quot;H-H SSF&quot;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">sk_array</span> <span class="o">=</span> <span class="n">sk_array_full</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">poptH</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">poly_fit</span><span class="p">,</span> <span class="n">ka_values</span><span class="p">,</span> <span class="n">sk_array</span><span class="p">[</span><span class="n">ka_mask</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ka_values</span><span class="p">,</span> <span class="n">poly_fit</span><span class="p">(</span><span class="n">ka_values</span><span class="p">,</span> <span class="o">*</span><span class="n">poptH</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Fit H-H&#39;</span><span class="p">)</span>

<span class="c1"># H-He Fit and plot</span>
<span class="n">sk_array_full</span> <span class="o">=</span> <span class="n">ssf</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[(</span><span class="s2">&quot;H-He SSF&quot;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">sk_array</span> <span class="o">=</span> <span class="n">sk_array_full</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">poptHHe</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">lin_fit</span><span class="p">,</span> <span class="n">ka_values</span><span class="p">,</span> <span class="n">sk_array</span><span class="p">[</span><span class="n">ka_mask</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ka_values</span><span class="p">,</span> <span class="n">lin_fit</span><span class="p">(</span><span class="n">ka_values</span><span class="p">,</span> <span class="o">*</span><span class="n">poptHHe</span><span class="p">),</span>  <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Fit H-He&#39;</span><span class="p">)</span>

<span class="c1"># He-He Fit and plot</span>
<span class="n">sk_array_full</span> <span class="o">=</span> <span class="n">ssf</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[(</span><span class="s2">&quot;He-He SSF&quot;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">sk_array</span> <span class="o">=</span> <span class="n">sk_array_full</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">poptHe</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">inv_fit</span><span class="p">,</span> <span class="n">ka_values</span><span class="p">,</span> <span class="n">sk_array</span><span class="p">[</span><span class="n">ka_mask</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ka_values</span><span class="p">,</span> <span class="n">inv_fit</span><span class="p">(</span><span class="n">ka_values</span><span class="p">,</span> <span class="o">*</span><span class="n">poptHe</span><span class="p">),</span>  <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Fit He-He&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span> <span class="o">=</span><span class="mi">2</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f40cc244550&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_BIM_H-He_Mixture_18_1.png" src="../../_images/examples_BIM_H-He_Mixture_18_1.png" />
</div>
</div>
<p>Pretty good, right? Now for the thermodynamic factor</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">ssf</span><span class="o">.</span><span class="n">species_concentrations</span>
<span class="n">Scc_k0</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">*</span><span class="n">inv_fit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">poptHe</span><span class="p">)</span> <span class="o">+</span> <span class="n">x1</span><span class="o">*</span><span class="n">poly_fit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">poptH</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">*</span><span class="n">lin_fit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">poptHHe</span><span class="p">))</span>
<span class="n">Therm_factor</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="n">Scc_k0</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;J = </span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Therm_factor</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
J = 1.0354
</pre></div></div>
</div>
<p>The value is ~ 1 which is what Hansen <em>et al.</em> assumed. Therefore we won’t use it below.</p>
<section id="Transport-Coefficients-in-Sarkas">
<h3>Transport Coefficients in Sarkas<a class="headerlink" href="#Transport-Coefficients-in-Sarkas" title="Permalink to this headline">¶</a></h3>
<p>Calculating transport coefficients is easy once the <a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients">TransportCoefficients</a> class from the <a class="reference external" href="../../api/sarkas.tools.transport.rst">sarkas.tools.transport</a> subpackage is imported.</p>
<p><a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients.interdiffusion">Interdiffusion</a> is a method of <a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients">TransportCoefficients</a> as such we need to initialize the class first which requires the following inputs</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters
----------
params : sarkas.base.Parameters
    Simulation&#39;s parameters.

phase : str, optional
    Phase to compute. Default = &#39;production&#39;.

no_slices : int, optional
    Number of slices of the simulation. Default = 1.

**kwargs:
    Arguments to pass :meth:`sarkas.tools.observables.FluxAutoCorrelationFunction`
</pre></div>
</div>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">params</span></code> is required as it contains relevant information. Notice the parameter <code class="docutils literal notranslate"><span class="pre">no_slices</span></code>. This represents the number of divisions in which we want to divide the full length of the time series. For each of these <code class="docutils literal notranslate"><span class="pre">slices</span></code> the method will integrate the ACF of the observable to get the transport coefficient.</p>
<p>The calculation of the transport coefficient is achieved by calling the method and passing the appropriate observable objects. The docstring can be found <a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients.interdiffusion">here</a>. As you can see it requires the appropriate observable which in this case is <a class="reference external" href="../../api/sarkas.tools.observables.rst#sarkas.tools.observables.DiffusionFlux">interdiffusion_df_slices</a>. The transport coefficient of each slice will be
stored as a column of a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> called <a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients.interdiffusion_df_slices">interdiffusion_df_slices</a>, the Mean and Std (over slices) will be stored in the <a class="reference external" href="../../api/sarkas.tools.transport.rst#sarkas.tools.transport.TransportCoefficients.interdiffusion_df">interdiffusion_df</a>.</p>
<p>The first column of these dataframes corresponds to the time in sec of each timestep.</p>
<p>The option <code class="docutils literal notranslate"><span class="pre">plot=True</span></code> will make a figure with two plots. On the left the ACF as a function of time and on the right a plot of the transport coefficient as a function of time with the corresponding errorband.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sarkas.tools.transport</span> <span class="kn">import</span> <span class="n">TransportCoefficients</span>
<span class="kn">from</span> <span class="nn">sarkas.tools.observables</span> <span class="kn">import</span> <span class="n">DiffusionFlux</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the diffusion flux by dividing the simulations into 4 smaller simulations</span>
<span class="n">jc_acf</span> <span class="o">=</span> <span class="n">DiffusionFlux</span><span class="p">()</span>
<span class="n">jc_acf</span><span class="o">.</span><span class="n">no_slices</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">jc_acf</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
<span class="n">jc_acf</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s look at it</span>
<span class="n">jc_acf</span><span class="o">.</span><span class="n">dataframe_slices</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Time</th>
      <th colspan="12" halign="left">Diffusion Flux 0</th>
    </tr>
    <tr>
      <th></th>
      <th>NaN</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
    </tr>
    <tr>
      <th></th>
      <th>NaN</th>
      <th>slice 0</th>
      <th>slice 0</th>
      <th>slice 0</th>
      <th>slice 1</th>
      <th>slice 1</th>
      <th>slice 1</th>
      <th>slice 2</th>
      <th>slice 2</th>
      <th>slice 2</th>
      <th>slice 3</th>
      <th>slice 3</th>
      <th>slice 3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000e+00</td>
      <td>1.993921e-31</td>
      <td>-8.374467e-31</td>
      <td>-9.471123e-32</td>
      <td>1.650410e-16</td>
      <td>-2.750060e-16</td>
      <td>-2.132580e-17</td>
      <td>-2.592813e-16</td>
      <td>-4.231939e-16</td>
      <td>5.125572e-16</td>
      <td>-4.154773e-17</td>
      <td>3.628596e-16</td>
      <td>2.464266e-16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.500000e-19</td>
      <td>3.019202e-17</td>
      <td>2.536946e-17</td>
      <td>3.126571e-18</td>
      <td>1.526589e-16</td>
      <td>-2.982007e-16</td>
      <td>-4.579669e-17</td>
      <td>-2.251972e-16</td>
      <td>-4.231959e-16</td>
      <td>5.181452e-16</td>
      <td>-5.253896e-17</td>
      <td>3.379070e-16</td>
      <td>2.268565e-16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.900000e-18</td>
      <td>6.201764e-17</td>
      <td>4.934061e-17</td>
      <td>4.431807e-18</td>
      <td>1.391056e-16</td>
      <td>-3.185411e-16</td>
      <td>-6.691581e-17</td>
      <td>-1.916298e-16</td>
      <td>-4.200004e-16</td>
      <td>5.135595e-16</td>
      <td>-6.553873e-17</td>
      <td>3.107889e-16</td>
      <td>2.084986e-16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.850000e-18</td>
      <td>9.485616e-17</td>
      <td>7.177066e-17</td>
      <td>3.852522e-18</td>
      <td>1.244862e-16</td>
      <td>-3.358978e-16</td>
      <td>-8.393863e-17</td>
      <td>-1.592913e-16</td>
      <td>-4.137426e-16</td>
      <td>4.986987e-16</td>
      <td>-8.010234e-17</td>
      <td>2.817022e-16</td>
      <td>1.911914e-16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.800000e-18</td>
      <td>1.280001e-16</td>
      <td>9.259796e-17</td>
      <td>1.410964e-18</td>
      <td>1.089811e-16</td>
      <td>-3.501835e-16</td>
      <td>-9.631634e-17</td>
      <td>-1.288192e-16</td>
      <td>-4.046605e-16</td>
      <td>4.736470e-16</td>
      <td>-9.582756e-17</td>
      <td>2.509364e-16</td>
      <td>1.746648e-16</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>2.370250e-15</td>
      <td>2.099584e-16</td>
      <td>-1.233453e-16</td>
      <td>1.169715e-16</td>
      <td>-4.095864e-16</td>
      <td>-3.794951e-16</td>
      <td>3.462978e-16</td>
      <td>-3.117694e-17</td>
      <td>4.556562e-16</td>
      <td>3.596185e-16</td>
      <td>-7.628444e-16</td>
      <td>4.937378e-16</td>
      <td>-1.258954e-16</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>2.371200e-15</td>
      <td>2.029564e-16</td>
      <td>-1.575947e-16</td>
      <td>9.064110e-17</td>
      <td>-3.848219e-16</td>
      <td>-3.929576e-16</td>
      <td>3.959465e-16</td>
      <td>-2.623574e-17</td>
      <td>4.408110e-16</td>
      <td>3.357565e-16</td>
      <td>-7.430279e-16</td>
      <td>4.567765e-16</td>
      <td>-1.791263e-16</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>2.372150e-15</td>
      <td>1.950846e-16</td>
      <td>-1.901676e-16</td>
      <td>6.264069e-17</td>
      <td>-3.566792e-16</td>
      <td>-4.045290e-16</td>
      <td>4.381401e-16</td>
      <td>-2.503433e-17</td>
      <td>4.243542e-16</td>
      <td>3.121659e-16</td>
      <td>-7.191573e-16</td>
      <td>4.188821e-16</td>
      <td>-2.290961e-16</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>2.373100e-15</td>
      <td>1.862069e-16</td>
      <td>-2.207674e-16</td>
      <td>3.393836e-17</td>
      <td>-3.258457e-16</td>
      <td>-4.136707e-16</td>
      <td>4.720722e-16</td>
      <td>-2.739204e-17</td>
      <td>4.060086e-16</td>
      <td>2.892282e-16</td>
      <td>-6.922675e-16</td>
      <td>3.801472e-16</td>
      <td>-2.746724e-16</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>2.374050e-15</td>
      <td>1.762159e-16</td>
      <td>-2.491263e-16</td>
      <td>5.591958e-18</td>
      <td>-2.931044e-16</td>
      <td>-4.199792e-16</td>
      <td>4.970616e-16</td>
      <td>-3.302129e-17</td>
      <td>3.855537e-16</td>
      <td>2.672468e-16</td>
      <td>-6.633041e-16</td>
      <td>3.405559e-16</td>
      <td>-3.149317e-16</td>
    </tr>
  </tbody>
</table>
<p>2500 rows × 13 columns</p>
</div></div>
</div>
<p>Notice that there is a column <code class="docutils literal notranslate"><span class="pre">Diffusion</span> <span class="pre">Flux</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">Diffusion</span> <span class="pre">Flux</span> <span class="pre">ACF</span> <span class="pre">0</span></code> for each slice. For the transport coefficient I will use <code class="docutils literal notranslate"><span class="pre">Diffusion</span> <span class="pre">Flux</span> <span class="pre">ACF</span> <span class="pre">0</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransportCoefficients</span><span class="p">(</span>
        <span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span>
        <span class="n">no_slices</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion</span><span class="p">(</span><span class="n">jc_acf</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1"># Note the info printed to screen</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


===================== Interdiffusion Coefficient =====================

Data saved in:
 Simulations/HeH_sim/PostProcessing/TransportCoefficients/Production/Interdiffusion_HeH_sim.h5
Simulations/HeH_sim/PostProcessing/TransportCoefficients/Production/Interdiffusion_slices_HeH_sim.h5

No. of slices = 4
No. dumps per slice = 250
Time interval of autocorrelation function = 2.3750e-15 [s] ~ 397 w_p T
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fb272ae5b2c84d17a57c5cdee6ec1a97", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_BIM_H-He_Mixture_27_2.png" src="../../_images/examples_BIM_H-He_Mixture_27_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s look at what we have</span>
<span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Time</th>
      <th colspan="2" halign="left">Inter Diffusion Flux 0</th>
    </tr>
    <tr>
      <th></th>
      <th>NaN</th>
      <th>Mean</th>
      <th>Std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.500000e-19</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.900000e-18</td>
      <td>0.000008</td>
      <td>3.826732e-07</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.850000e-18</td>
      <td>0.000017</td>
      <td>7.656943e-07</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.800000e-18</td>
      <td>0.000025</td>
      <td>1.148443e-06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>2.370250e-15</td>
      <td>0.000012</td>
      <td>1.937744e-04</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>2.371200e-15</td>
      <td>0.000014</td>
      <td>1.957540e-04</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>2.372150e-15</td>
      <td>0.000016</td>
      <td>1.975726e-04</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>2.373100e-15</td>
      <td>0.000017</td>
      <td>1.992226e-04</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>2.374050e-15</td>
      <td>0.000018</td>
      <td>2.006965e-04</td>
    </tr>
  </tbody>
</table>
<p>2500 rows × 3 columns</p>
</div></div>
</div>
<p>As mentioned the InterDiffusion is calculated for each slice and then averaged. The left plot above shows the mean over the four slices of the Diffusion Flux ACF with its standard deviation as the shaded area. The upper x-axis (Index) indicates the index value in the dataframe.</p>
<p>Let’s now plot this and compare with Hansen <em>et al.</em> result.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aws</span> <span class="o">=</span> <span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">a_ws</span>
<span class="n">vaa</span> <span class="o">=</span> <span class="n">postproc</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">hydrodynamic_frequency</span>
<span class="n">norm</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">vaa</span> <span class="o">*</span> <span class="n">aws</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[(</span><span class="s2">&quot;Inter Diffusion Flux 0&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span> <span class="o">*</span> <span class="n">norm</span> <span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Sarkas&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span>
    <span class="n">norm</span> <span class="o">*</span> <span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[(</span><span class="s2">&quot;Inter Diffusion Flux 0&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e15</span><span class="p">,</span> <span class="c1"># I don&#39;t understand why I need iloc here but not above</span>
    <span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[(</span><span class="s2">&quot;Inter Diffusion Flux 0&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span> <span class="o">-</span> <span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[(</span><span class="s2">&quot;Inter Diffusion Flux 0&quot;</span><span class="p">,</span><span class="s2">&quot;Std&quot;</span><span class="p">)])</span><span class="o">*</span><span class="n">norm</span><span class="p">,</span>
    <span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[(</span><span class="s2">&quot;Inter Diffusion Flux 0&quot;</span><span class="p">,</span><span class="s2">&quot;Mean&quot;</span><span class="p">)]</span> <span class="o">+</span> <span class="n">tc</span><span class="o">.</span><span class="n">interdiffusion_df</span><span class="p">[(</span><span class="s2">&quot;Inter Diffusion Flux 0&quot;</span><span class="p">,</span><span class="s2">&quot;Std&quot;</span><span class="p">)])</span><span class="o">*</span><span class="n">norm</span><span class="p">,</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0109</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HJM value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xscale</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time [fs]&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;H-He Interdiffusion $\Gamma = 40$&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[None,
 Text(0.5, 0, &#39;Time [fs]&#39;),
 Text(0.5, 1.0, &#39;H-He Interdiffusion $\\Gamma = 40$&#39;)]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_BIM_H-He_Mixture_30_1.png" src="../../_images/examples_BIM_H-He_Mixture_30_1.png" />
</div>
</div>
<p>Looks good to me!</p>
</section>
</section>
</section>


    </div>
      
  </div>
</div> 
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019-2022, MurilloGroup.<br/>
      Last updated on Mar 18, 2022.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br/>
    </p>
  </div>
</footer>

  <script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
      })
  </script>

  <style>
    /* Sidebar header (and topbar for mobile) */
    /* .wy-side-nav-search,  */
    .wy-nav-top {
      background: #18453b;
    }
    /* Sidebar */
    .wy-nav-side {
      background: #535054;
    }
    .wy-menu-vertical p.caption {
	  color: #fff;
	}
	.wy-menu-vertical a {
	  color: #eee;
	}
	.wy-menu-vertical a:hover {
    background-color: #18453b;
  }
 /* .wy-nav-content {
    max-width: 900px !important;
  } */
}
  </style>

  </body>
</html>